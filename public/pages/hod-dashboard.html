<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOD Dashboard - EduSquare</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <link href="../css/dashboard.css" rel="stylesheet">
    <style>
        .class-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .class-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }
        .class-card.active {
            border-color: #0d6efd;
            box-shadow: 0 5px 15px rgba(13,110,253,0.2);
        }
        .tab-content {
            padding: 20px;
            border: 1px solid #dee2e6;
            border-top: 0;
            border-radius: 0 0 8px 8px;
        }
        .step-badge {
            background-color: #0d6efd;
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
        }
        .feature-icon {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 50%;
            color: #0d6efd;
            font-size: 24px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">EduSquare HOD</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-page="dashboard">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="view-faculty">
                            <i class="fas fa-chalkboard-teacher"></i> View Faculty
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="class-manager">
                            <i class="fas fa-th-large"></i> Class Manager
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="logout">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Dashboard Overview -->
        <div id="dashboard-page" class="page active">
            
            <p class="lead mb-4">Welcome to the HOD dashboard, designed for academic heads to manage faculty, classes, students, subjects, timetables, and attendance at the department level.</p>
            
            <div class="row">
                <div class="col-md-3">
                    <div class="dashboard-card stats-card">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <h3>Total Faculty</h3>
                        <h2 id="total-faculty">0</h2>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="dashboard-card stats-card">
                        <i class="fas fa-user-graduate"></i>
                        <h3>Total Students</h3>
                        <h2 id="total-students">0</h2>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="dashboard-card stats-card">
                        <i class="fas fa-book"></i>
                        <h3>Total Subjects</h3>
                        <h2 id="total-subjects">0</h2>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="dashboard-card stats-card">
                        <i class="fas fa-calendar-alt"></i>
                        <h3>Total Classes</h3>
                        <h2 id="total-classes">0</h2>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-md-12">
                    <div class="dashboard-card">
                        <h3>Attendance Overview</h3>
                        <canvas id="attendance-chart" style="height: 400px;"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="row mt-4">
                <div class="col-12">
                    <div class="dashboard-card">
                        <h3>Quick Actions</h3>
                        <div class="row text-center">
                            <div class="col-md-4 mb-3">
                                <a href="#" class="btn btn-outline-primary w-100" data-page="view-faculty">
                                    <i class="fas fa-chalkboard-teacher me-2"></i>View Faculty
                                </a>
                            </div>
                            <div class="col-md-4 mb-3">
                                <a href="#" class="btn btn-outline-primary w-100" data-page="class-manager">
                                    <i class="fas fa-th-large me-2"></i>Class Manager
                                </a>
                            </div>
                            <div class="col-md-4 mb-3">
                                <a href="#" class="btn btn-outline-primary w-100" id="download-reports">
                                    <i class="fas fa-download me-2"></i>Download Reports
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- View Faculty Page -->
        <div id="view-faculty-page" class="page">
            <div class="dashboard-card">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 class="m-0"><i class="fas fa-search me-2"></i> View Faculty Added by Admin</h2>
                    <button class="btn btn-sm btn-outline-secondary" id="refresh-faculty-list">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text">Faculty Name</span>
                            <input type="text" class="form-control" id="filter-faculty-name" placeholder="Filter by name...">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text">Department</span>
                            <select class="form-select" id="filter-faculty-department">
                                <option value="">All Departments</option>
                                <option value="CSE">CSE</option>
                                <option value="ECE">ECE</option>
                                <option value="IT">IT</option>
                                <option value="MECH">MECH</option>
                                <option value="CIVIL">CIVIL</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-primary w-100" id="apply-faculty-filters">
                            <i class="fas fa-filter me-2"></i>Apply Filters
                        </button>
                    </div>
                </div>
                
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-light">
                            <tr>
                                <th>Faculty Name</th>
                                <th>Department</th>
                                <th>Email</th>
                                <th>Subjects</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="faculty-list">
                            <!-- Faculty members will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Add Students Page -->
        <div id="add-students-page" class="page">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="dashboard-card">
                        <h2 class="mb-4">Add New Students</h2>
                        <form id="add-students-form">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Year</label>
                                        <select class="form-select" name="year" required>
                                            <option value="">Select Year</option>
                                            <option value="1">First Year</option>
                                            <option value="2">Second Year</option>
                                            <option value="3">Third Year</option>
                                            <option value="4">Fourth Year</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Department</label>
                                        <input type="text" class="form-control" name="department" required>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Section</label>
                                        <input type="text" class="form-control" name="section" required>
                                    </div>
                                </div>
                            </div>

                            <div id="students-container">
                                <div class="student-entry border p-3 mb-3">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="mb-3">
                                                <label class="form-label">Name</label>
                                                <input type="text" class="form-control" name="students[0][name]" required>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="mb-3">
                                                <label class="form-label">Roll Number</label>
                                                <input type="text" class="form-control" name="students[0][rollNumber]" required>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="mb-3">
                                                <label class="form-label">Email</label>
                                                <input type="email" class="form-control" name="students[0][email]" required>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="mb-3">
                                                <label class="form-label">&nbsp;</label>
                                                <button type="button" class="btn btn-danger d-block w-100 remove-student">Remove</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button type="button" class="btn btn-secondary mb-3" id="add-more-students">Add More Students</button>
                            <button type="submit" class="btn btn-primary d-block w-100">Add Students</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Subjects Page -->
        <div id="add-subjects-page" class="page">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="dashboard-card">
                        <h2 class="mb-4">Add Subjects</h2>
                        <form id="add-subjects-form">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Year</label>
                                        <select class="form-select" name="year" required>
                                            <option value="">Select Year</option>
                                            <option value="1">First Year</option>
                                            <option value="2">Second Year</option>
                                            <option value="3">Third Year</option>
                                            <option value="4">Fourth Year</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Department</label>
                                        <input type="text" class="form-control" name="department" required>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Section</label>
                                        <input type="text" class="form-control" name="section" required>
                                    </div>
                                </div>
                            </div>

                            <div id="subjects-container">
                                <div class="subject-entry border p-3 mb-3">
                                    <div class="row">
                                        <div class="col-md-5">
                                            <div class="mb-3">
                                                <label class="form-label">Subject Name</label>
                                                <input type="text" class="form-control" name="subjects[0][name]" required>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="mb-3">
                                                <label class="form-label">Subject Code</label>
                                                <input type="text" class="form-control" name="subjects[0][code]">
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="mb-3">
                                                <label class="form-label">Type</label>
                                                <select class="form-select" name="subjects[0][type]" required>
                                                    <option value="Theory">Theory</option>
                                                    <option value="Lab">Lab</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="mb-3">
                                                <label class="form-label">&nbsp;</label>
                                                <button type="button" class="btn btn-danger d-block w-100 remove-subject">Remove</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button type="button" class="btn btn-secondary mb-3" id="add-more-subjects">Add More Subjects</button>
                            <button type="submit" class="btn btn-primary d-block w-100">Add Subjects</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Timetable Page -->
        <div id="add-timetable-page" class="page">
            <div class="dashboard-card">
                <h2 class="mb-4">Create Timetable</h2>
                <form id="add-timetable-form">
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label class="form-label">Year</label>
                                <select class="form-select" name="year" required>
                                    <option value="">Select Year</option>
                                    <option value="1">First Year</option>
                                    <option value="2">Second Year</option>
                                    <option value="3">Third Year</option>
                                    <option value="4">Fourth Year</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label class="form-label">Department</label>
                                <input type="text" class="form-control" name="department" required>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label class="form-label">Section</label>
                                <input type="text" class="form-control" name="section" required>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label class="form-label">Week Start Date</label>
                                <input type="date" class="form-control" name="weekStartDate" required>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Time/Day</th>
                                    <th>Monday</th>
                                    <th>Tuesday</th>
                                    <th>Wednesday</th>
                                    <th>Thursday</th>
                                    <th>Friday</th>
                                    <th>Saturday</th>
                                </tr>
                            </thead>
                            <tbody id="timetable-grid">
                                <!-- Timetable slots will be generated here -->
                            </tbody>
                        </table>
                    </div>

                    <div class="text-end mt-4">
                        <button type="button" class="btn btn-secondary me-2" id="add-time-slot">Add Time Slot</button>
                        <button type="submit" class="btn btn-primary">Create Timetable</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- View Attendance Page -->
        <div id="view-attendance-page" class="page">
            <div class="dashboard-card">
                <h2 class="mb-4">Student Attendance</h2>
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="mb-3">
                            <label class="form-label">Year</label>
                            <select class="form-select" id="attendance-year">
                                <option value="">Select Year</option>
                                <option value="1">First Year</option>
                                <option value="2">Second Year</option>
                                <option value="3">Third Year</option>
                                <option value="4">Fourth Year</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="mb-3">
                            <label class="form-label">Department</label>
                            <input type="text" class="form-control" id="attendance-department">
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="mb-3">
                            <label class="form-label">Section</label>
                            <input type="text" class="form-control" id="attendance-section">
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="mb-3">
                            <label class="form-label">&nbsp;</label>
                            <button class="btn btn-primary d-block w-100" id="fetch-attendance">Fetch Attendance</button>
                        </div>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Student Name</th>
                                <th>Roll Number</th>
                                <th>Subject-wise Attendance</th>
                                <th>Overall %</th>
                            </tr>
                        </thead>
                        <tbody id="attendance-list">
                            <!-- Attendance data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Class Manager Page -->
        <div id="class-manager-page" class="page">
            <div class="dashboard-card mb-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 class="m-0"><i class="fas fa-th-large me-2"></i> Class Manager</h2>
                    <div>
                        <button class="btn btn-sm btn-outline-secondary me-2" id="refresh-classes">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                        <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addClassModal">
                            <i class="fas fa-plus"></i> Add New Class
                        </button>
                    </div>
                </div>
                
                <p class="lead">The Class Manager is a centralized section where you can create and manage all elements of a class (Year + Department + Section), including subjects, students, timetables, and attendance.</p>

                
                <!-- Class List -->
                <div class="row mt-4" id="class-list-container">
                    <!-- Classes will be loaded here -->
                </div>
            </div>

            <!-- Selected Class Management -->
            <div id="class-management" class="dashboard-card" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 id="selected-class-title">Class Management</h3>
                    <button class="btn btn-sm btn-outline-secondary" id="back-to-classes">
                        <i class="fas fa-arrow-left"></i> Back to Classes
                    </button>
                </div>

                <!-- Class Management Tabs -->
                <ul class="nav nav-tabs" id="classManagementTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="subjects-tab" data-bs-toggle="tab" data-bs-target="#subjects" type="button" role="tab" aria-controls="subjects" aria-selected="true">
                            <i class="fas fa-book me-2"></i> Subjects & Faculty
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="students-tab" data-bs-toggle="tab" data-bs-target="#students" type="button" role="tab" aria-controls="students" aria-selected="false">
                            <i class="fas fa-user-graduate me-2"></i> Students
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="timetable-tab" data-bs-toggle="tab" data-bs-target="#timetable" type="button" role="tab" aria-controls="timetable" aria-selected="false">
                            <i class="fas fa-calendar-alt me-2"></i> Timetable
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="attendance-tab" data-bs-toggle="tab" data-bs-target="#attendance" type="button" role="tab" aria-controls="attendance" aria-selected="false">
                            <i class="fas fa-clipboard-check me-2"></i> Attendance
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="classManagementTabContent">
                    <!-- Subjects & Faculty Tab -->
                    <div class="tab-pane fade show active" id="subjects" role="tabpanel" aria-labelledby="subjects-tab">
                        <div class="p-3">
                            <h4 class="mb-3"><span class="step-badge">1</span> Add Subjects & Assign Faculty</h4>
                            <form id="add-subject-form" class="mb-4">
                                <input type="hidden" id="class-id-for-subject" name="classId">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Subject Name</label>
                                            <input type="text" class="form-control" name="name" placeholder="E.g. Data Structures" required>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="mb-3">
                                            <label class="form-label">Subject Code</label>
                                            <input type="text" class="form-control" name="code" placeholder="E.g. CS201">
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="mb-3">
                                            <label class="form-label">Type</label>
                                            <select class="form-select" name="type" required>
                                                <option value="Theory">Theory</option>
                                                <option value="Lab">Lab</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="mb-3">
                                            <label class="form-label">Assigned Faculty</label>
                                            <select class="form-select" name="facultyId" id="faculty-dropdown" required>
                                                <option value="" selected disabled>Select Faculty</option>
                                                <!-- Faculty options will be loaded here -->
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2 d-flex align-items-end">
                                        <button type="submit" class="btn btn-primary w-100">Add Subject</button>
                                    </div>
                                </div>
                            </form>

                            <h5 class="mb-3">Subjects List</h5>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover" id="subjects-table">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Subject Name</th>
                                            <th>Code</th>
                                            <th>Type</th>
                                            <th>Faculty</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="subjects-list">
                                        <!-- Subjects will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Edit Subject Modal -->
                            <div class="modal fade" id="editSubjectModal" tabindex="-1" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Edit Subject</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <form id="edit-subject-form">
                                            <div class="modal-body">
                                                <input type="hidden" id="edit-subject-id" name="subjectId">
                                                <input type="hidden" id="edit-class-id" name="classId">
                                                
                                                <div class="mb-3">
                                                    <label class="form-label">Subject Name</label>
                                                    <input type="text" class="form-control" id="edit-subject-name" name="name" required>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label class="form-label">Subject Code</label>
                                                    <input type="text" class="form-control" id="edit-subject-code" name="code" required>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label class="form-label">Type</label>
                                                    <select class="form-select" id="edit-subject-type" name="type" required>
                                                        <option value="Theory">Theory</option>
                                                        <option value="Lab">Lab</option>
                                                    </select>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label class="form-label">Assigned Faculty</label>
                                                    <select class="form-select" id="edit-subject-faculty" name="facultyId" required>
                                                        <option value="" disabled>Select Faculty</option>
                                                        <!-- Faculty options will be loaded here -->
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                <button type="submit" class="btn btn-primary">Save Changes</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                    <!-- Students Tab -->
                    <div class="tab-pane fade" id="students" role="tabpanel" aria-labelledby="students-tab">
                        <div class="p-3">
                            <h4 class="mb-3"><span class="step-badge">2</span> Add Students (Bulk Upload)</h4>
                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <form id="upload-students-form">
                                        <input type="hidden" id="class-id-for-students" name="classId">
                                        <div class="mb-3">
                                            <label class="form-label">Upload Student Data (CSV/Excel)</label>
                                            <input type="file" class="form-control" name="file" accept=".csv,.xlsx" required>
                                        </div>
                                        <div class="mb-3">
                                            <button type="submit" class="btn btn-primary">
                                                <i class="fas fa-upload me-2"></i>Upload Students
                                            </button>
                                        </div>
                                    </form>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header bg-light">
                                            <strong>CSV/Excel Template Format</strong>
                                        </div>
                                        <div class="card-body">
                                            <p>Your file should contain the following columns:</p>
                                            <ul>
                                                <li><strong>name</strong> - Full name of the student</li>
                                                <li><strong>rollNumber</strong> - Unique roll number/ID</li>
                                                <li><strong>email</strong> - Email address of the student</li>
                                            </ul>
                                            <a href="#" class="btn btn-sm btn-outline-primary" id="download-template">
                                                <i class="fas fa-download me-1"></i> Download Template
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <h5 class="mb-3">Students List</h5>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover" id="students-table">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Name</th>
                                            <th>Roll Number</th>
                                            <th>Email</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="students-list">
                                        <!-- Students will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Timetable Tab -->
                    <div class="tab-pane fade" id="timetable" role="tabpanel" aria-labelledby="timetable-tab">
                        <div class="p-3">
                            <h4 class="mb-3"><span class="step-badge">3</span> Add Timetable</h4>
                            <form id="add-timetable-form">
                                <input type="hidden" id="class-id-for-timetable" name="classId">
                                <div class="card mb-4">
                                    <div class="card-header bg-light">
                                        <h5 class="m-0">Step 1: Add Timetable Slots</h5>
                                    </div>
                                    <div class="card-body">
                                        <div id="timetable-slots">
                                            <div class="timetable-slot border p-3 mb-3">
                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <div class="mb-3">
                                                            <label class="form-label">Day</label>
                                                            <select class="form-select" name="slots[0][day]" required>
                                                                <option value="Monday">Monday</option>
                                                                <option value="Tuesday">Tuesday</option>
                                                                <option value="Wednesday">Wednesday</option>
                                                                <option value="Thursday">Thursday</option>
                                                                <option value="Friday">Friday</option>
                                                                <option value="Saturday">Saturday</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="mb-3">
                                                            <label class="form-label">Time Slot</label>
                                                            <div class="input-group">
                                                                <input type="time" class="form-control" name="slots[0][startTime]" required>
                                                                <span class="input-group-text">to</span>
                                                                <input type="time" class="form-control" name="slots[0][endTime]" required>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="mb-3">
                                                            <label class="form-label">Subject</label>
                                                            <select class="form-select slot-subject" name="slots[0][subject]" required>
                                                                <option value="" selected disabled>Select Subject</option>
                                                                <!-- Subjects will be loaded here -->
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="mb-3">
                                                            <label class="form-label">Faculty</label>
                                                            <select class="form-select slot-faculty" name="slots[0][faculty]" required disabled>
                                                                <option value="" selected disabled>Select Subject First</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-1 d-flex align-items-end">
                                                        <button type="button" class="btn btn-danger remove-slot">Ã—</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <button type="button" class="btn btn-outline-primary" id="add-slot">
                                            <i class="fas fa-plus"></i> Add Time Slot
                                        </button>
                                    </div>
                                </div>

                                <div class="card mb-4">
                                    <div class="card-header bg-light">
                                        <h5 class="m-0">Step 2: Auto-Repeat Schedule</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" value="1" id="auto-repeat" name="autoRepeat" checked>
                                            <label class="form-check-label" for="auto-repeat">
                                                Auto-generate schedule for the next 4 weeks
                                            </label>
                                        </div>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save me-2"></i>Save Timetable
                                        </button>
                                    </div>
                                </div>
                            </form>

                            <h5 class="mb-3">Current Timetable</h5>
                            <div class="table-responsive">
                                <table class="table table-bordered" id="current-timetable">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Time / Day</th>
                                            <th>Monday</th>
                                            <th>Tuesday</th>
                                            <th>Wednesday</th>
                                            <th>Thursday</th>
                                            <th>Friday</th>
                                            <th>Saturday</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Timetable will be generated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Attendance Tab -->
                    <div class="tab-pane fade" id="attendance" role="tabpanel" aria-labelledby="attendance-tab">
                        <div class="p-3">
                            <h4 class="mb-3"><span class="step-badge">4</span> View Student Attendance</h4>
                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Filter by Subject</label>
                                        <select class="form-select" id="attendance-subject-filter">
                                            <option value="">All Subjects</option>
                                            <!-- Subjects will be loaded here -->
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Date Range</label>
                                        <div class="input-group">
                                            <input type="date" class="form-control" id="attendance-start-date">
                                            <span class="input-group-text">to</span>
                                            <input type="date" class="form-control" id="attendance-end-date">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4 d-flex align-items-end">
                                    <button class="btn btn-primary w-100" id="filter-attendance">
                                        <i class="fas fa-filter me-2"></i>Apply Filters
                                    </button>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="table table-striped table-bordered" id="attendance-table">
                                    <thead class="table-light">
                                        <tr>
                                            <th rowspan="2">Student Name</th>
                                            <th rowspan="2">Roll Number</th>
                                            <th colspan="3" class="text-center">Subject-wise Attendance</th>
                                        </tr>
                                        <tr id="subject-header-row">
                                            <!-- Subject columns will be generated here -->
                                        </tr>
                                    </thead>
                                    <tbody id="attendance-data">
                                        <!-- Attendance data will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Class Modal -->
        <div class="modal fade" id="addClassModal" tabindex="-1" aria-labelledby="addClassModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addClassModalLabel"><i class="fas fa-plus-circle me-2"></i> Add New Class</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="add-class-form">
                            <div class="mb-3">
                                <label for="class-year" class="form-label">Year</label>
                                <select class="form-select" id="class-year" name="year" required>
                                    <option value="" selected disabled>Select Year</option>
                                    <option value="1st">1st Year</option>
                                    <option value="2nd">2nd Year</option>
                                    <option value="3rd">3rd Year</option>
                                    <option value="4th">4th Year</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="class-department" class="form-label">Department</label>
                                <div class="form-control" id="hod-department">Loading...</div>
                                <small class="text-muted">Department is automatically set from your profile</small>
                                <!-- Hidden field to maintain form structure, but it won't be used -->
                                <input type="hidden" id="class-department" name="department" value="">
                            </div>
                            <div class="mb-3">
                                <label for="class-section" class="form-label">Section</label>
                                <select class="form-select" id="class-section" name="section" required>
                                    <option value="" selected disabled>Select Section</option>
                                    <option value="A">Section A</option>
                                    <option value="B">Section B</option>
                                    <option value="C">Section C</option>
                                    <option value="D">Section D</option>
                                </select>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="save-class">Create Class</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/hod.js"></script>
</body>
</html>
